<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">     
    <!-- Bootstrap Icons CDN -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <!-- Bootstrap CSS CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/src/styles/style.css">
    <title>Pomodoro</title>
</head>
<body class="container-fluid m-5">
    <h1>POMODORO</h1>
    <div id="pomoBox">
        <div id="pomoHeader">
            <ul class="nav nav-underline">
                <li class="nav-item">
                    <a class="nav-link" aria-current="page" data-category="shortSession">Short Session</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-category="break">Break</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-category="longSession">Long Session</a>
                </li>
            </ul>
        </div>
        <div id="pomoBody">20:00</div>
        <button id="pomoSrt">Start</button>
    </div>
    <!-- jQuery CDN -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <!-- Bootstrap Bundle JS CDN -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script type="text/javascript">
        let pomoBody= document.getElementById('pomoBody');
        let navLink = document.querySelectorAll('.nav-link');
        let category= 'shortSession';
        navLink.forEach(button=>{
            button.addEventListener('click', ()=>{
                category = button.getAttribute("data-category")
                console.log(category)
                switch(category){
                    case 'shortSession' : 
                            pomoBody.innerHTML= "20:00"
                            category="shortSession"
                    break;
                    case 'longSession' :
                            pomoBody.innerHTML= "40:00"
                            category="longSession"
                    break;
                    case 'break' :
                            pomoBody.innerHTML= "10:00"
                            category="break"
                    break;
                }
                
            })
        })
        let time= null;
        document.getElementById('pomoSrt').addEventListener('click', ()=>{
            console.log("button is working");
            
            switch(category){
                    case 'shortSession' : 
                        time= 20*60; //time in seconds
                        console.log(time);
                        timer(time)
                    break;
                    case 'longSession' :
                        time= 40*60; //time in seconds
                        console.log(time);
                        timer(time)
                    break;
                    case 'break' :
                        time= 10*60; //time in seconds
                        console.log(time);
                        timer(time)
                    break;
                }
        })
        let timerRunning=null;
        function timer(time){
            if(timerRunning) {
                alert("Session is already running!!")
                return;
            }
            timerRunning = setInterval(()=>{
                while(time>0){
                    time--;
                    let minutes = Math.floor(time / 60);
                    let seconds = time % 60;
                    pomoBody.innerHTML = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                }
                clearInterval();
                timerRunning = null;
                alert("Session is over")
            })
        }

    </script>
</body>
</html>